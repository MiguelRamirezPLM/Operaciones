@model IEnumerable<plm_spGetProductsToEditByDivision>
@using Web.Models;
@{
    ViewBag.Title = "Ventas";
    Web.Models.Sessions.SessionM _Session1 = (Web.Models.Sessions.SessionM)Session["SessionM"];
    SessionCountryByDivision _Session = (SessionCountryByDivision)Session["SessionCountryByDivision"];
    Medinet db = new Medinet();

    var ct_co = db.ContentTypes.Where(x => x.ContentType == "CON CAMBIO ORTOGRÁFICO" && x.Active == true).ToList();
    var ct_cf = db.ContentTypes.Where(x => x.ContentType == "CON CAMBIO DE FONDO" && x.Active == true).ToList();

    int DivisionId, EditionId, BookId, CountryId;
    if (_Session != null)
    {
        DivisionId = _Session.DivisionId;
        EditionId = _Session.EditionId;
        BookId = _Session.BookId;
        CountryId = _Session.CountryId;
    }
    else
    {
        DivisionId = 0;
        EditionId = 0;
        BookId = 0;
        CountryId = 0;
    }
}
@*agregar producto*@

<script>
    function getpharmaformstoaddproduct(item)
    {
        $("#txtProductName").val("");
    }
</script>
<script>
    function createproduct() {

        var _pname = $("#txtProductName").val();
        //if (_pname.trim() == false)
        //{   
        //    swal({ title: "¡Atención!", type: "error", text: "El nombre del producto no puede quedar vacio" });
        //}
        var _pfid = $("#selectpfaddproduct").val();
        var _pt = $("#ProductTypes").val();
        var _did = $("#DivisionId").val();
        var _cid = $("#CountryId").val();
        var _cat = $("#Categories").val();
        var _eid = $("#EditionId").val();
        var _pdesc = $("#Pdescription").val();
        var _reg = $("#Regsanitary").val();
        var _cfp = $("#COFEPRIS").val();

        if ((!_pname.trim() == false) && (_pfid != 0) && (_cat != 0) && (_pt != null) && (_pt != "null")) {
            $.ajax({
                Type: "POST",
                dataType: "Json",
                url: "@Url.Content("~/Sales/createproduct")",
                traditional: true,
                data: {
                    ProductName: _pname,
                    Division: _did,
                    PharmaForm: _pfid,
                    Country: _cid,
                    ProductType: _pt,
                    Category: _cat,
                    Edition: _eid,
                    Description: _pdesc,
                    Register: _reg,
                    SS: _cfp
                },
                success: function (data) {
                    if (data == false) {
                        swal({ title: "¡Atención!", type: "error", text: "El producto ya existe" });
                    }
                    else {
                        swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                    }
                }
            })
        }
        else {
            alert();
            if (!pname.trim() == true) {
                $("#bloqueo").hide();

                $(".errorP").show();

                $("#divProductName").addClass("has-error");
            }
            if (pfid == 0) {

                $("#divpfaddproduct").addClass("has-error");

                $(".errorPF").show();
            }
            if (cat == 0) {

                $("#divCategories").addClass("has-error");

                $(".errorC").show();
            }
            if (pt == "null") {

                $("#divProductTypes").addClass("has-error");

                $(".errorPT").show();
            }
        }
    }
</script>


<script>
    function cancelcreateproduct() {

        $("#bloqueo").hide();

        $("#divProductName").removeClass("has-error");

        $(".errorP").hide();

        $("#txtProductName").val('');

        $("#divpfaddproduct").removeClass("has-error");

        $(".errorPF").hide();

        $("#selectpfaddproduct").empty();

        $("#divCategories").removeClass("has-error");

        $(".errorC").hide();

        var elmc = document.getElementById("cat0");

        $("#Categories").val($(elmc).val());

        $("#divProductTypes").removeClass("has-error");

        $(".errorPT").hide();

        var elmpt = document.getElementById("ptnull");

        $("#ProductTypes").val($(elmpt).val());

        $("#Pdescription").val('');

        $("#Regsanitary").val('');

        $("#COFEPRIS").val('');
    }
</script>

@*Agregar forma farmaceutica a un producto*@
<script>
    function getproductstoaddpf() {
        $("#selectproduct").empty();

        var cid = $("#CountryId").val();
        var bid = $("#BookId").val();
        var eid = $("#EditionId").val();
        var did = $("#DivisionId").val();

        $.ajax({
            Type: "POST",
            dataType: "Json",
            url: "@Url.Content("~/Sales/getproductstoaddpf")",
            data: { CountryId: cid, BookId: bid, EditionId: eid, DivisionId: did },
            success: function (data) {
                $('#selectproduct').empty();
                $('#selectproduct')
                   .append($("<option value='0'></option>")
                   .attr("value", 0)
                   .text("Seleccione..."));
                $.each(data, function (index, val) {
                    $('#selectproduct')
                    .append($("<option id=" + val.ProductId + "></option>")
                    .attr("value", val.ProductId)
                    .text(val.Brand));
                });
            }
        })
    }
</script>
<script>
    function getpharmaformswithoutproducts(value) {
        if (value != 0) {
            $(".trpharmaform").show();

            $.ajax({
                Type: "POST",
                dataType: "Json",
                url: "@Url.Content("~/Sales/getpharmaformswithoutproducts")",
                data: { Product: value },
                success: function (data) {
                    $('#selectpharmaform').empty();
                    $('#selectpharmaform')
                       .append($("<option value='0' id='pfwp0'></option>")
                       .attr("value", 0)
                       .text("Seleccione..."));
                    $.each(data, function (index, val) {
                        $('#selectpharmaform')
                        .append($("<option></option>")
                        .attr("value", val.PharmaFormId)
                        .text(val.Description));
                    });
                }
            })
        }
    }
</script>

@*Ediciones que participa un produto*@
<script>
    function _getParticipant(item) {
        var tr = $(item).parents("tr:first");
        var _productId = tr.find("#_productId").val();
        var _pharmaformId = tr.find("#_pharmaformId").val();
        var _categoryId = tr.find("#_categoryId").val();
        var _divisionid = tr.find("#_divisionId").val();
        var _getproductName = tr.find("#_productName").text();
        var _getpharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _getcategoryName = tr.find("#_categoryName").text();
        $("#_wproductName").empty();
        $("#_wproductName").append(_getproductName);
        $("#_wpharmaceuticalForm").empty();
        $("#_wpharmaceuticalForm").append(_getpharmaceuticalForm);
        $("#_wcategoryName").empty();
        $("#_wcategoryName").append(_getcategoryName);
        $("#_elementTable tbody").empty();
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Sales/getParticipantProducts")",
            traditional: true,
            data: {
                ProductId: _productId,
                PharmaFormId: _pharmaformId,
                Categoryid: _categoryId,
                DivisionId: _divisionid
            },
            success: function (data) {
                $.each(data, function (index, item) {
                    $("#_elementTable tbody").append(
                        "<tr>"
                        + "<td>" + item.ShortName + "</td>"
                        + "<td>" + item.NumberEdition + "</td>"
                        + "<td>" + item.TypeName + "</td>"
                        + "<td>" + item.ISBN + "</td>"
                        + "<td>" + item.ParentName + "<span style='padding-left:5px;'>" + item.NumberEditionParent + "</span>" + "</td>"
                        + "</tr>"
                        );
                });
            }
        });
    }
</script>

@*Registro sanitario*@
<script>
    var _positionSanitary;
    function _getSanitary(item) {
        var tr = $(item).parents("tr:first");
        _positionSanitary = tr;
        var _getproductName = tr.find("#_productName").text();
        var _getpharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _getcategoryName = tr.find("#_categoryName").text();
        var _getSanitaryRegister = tr.find("#_sanitaryRegister").text();
        $("#_messageRegister").empty();
        $("#_messageRegister").append("Modifique el registro sanitario");
        $("#_addRegister").addClass("hide");
        $("#_saveRegister").removeClass("hide");
        $("#_rproductName").empty();
        $("#_rproductName").append(_getproductName);
        $("#_rpharmaceuticalForm").empty();
        $("#_rpharmaceuticalForm").append(_getpharmaceuticalForm);
        $("#_rcategoryName").empty();
        $("#_rcategoryName").append(_getcategoryName);
        $("#_setSanitary").val(_getSanitaryRegister);
    }
</script>
<script>
    var _positionSanitary;
    function _plusRegister(item) {
        var tr = $(item).parents("tr:first");
        _positionSanitary = tr;
        var _getproductName = tr.find("#_productName").text();
        var _getpharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _getcategoryName = tr.find("#_categoryName").text();
        var _getSanitaryRegister = tr.find("#_sanitaryRegister").text();
        $("#_messageRegister").empty();
        $("#_messageRegister").append("Agregue el Registro Sanitario");
        $("#_addRegister").removeClass("hide");
        $("#_saveRegister").addClass("hide");
        $("#_rproductName").empty();
        $("#_rproductName").append(_getproductName);
        $("#_rpharmaceuticalForm").empty();
        $("#_rpharmaceuticalForm").append(_getpharmaceuticalForm);
        $("#_rcategoryName").empty();
        $("#_rcategoryName").append(_getcategoryName);
        $("#_setSanitary").val(_getSanitaryRegister);
    }
</script>
<script>
    function _saveRegister(item) {
        var _getsanitary = $("#_setSanitary").val();
        _positionSanitary.find("#_sanitaryRegister").empty();
        _positionSanitary.find("#_sanitaryRegister").append(_getsanitary);
        var _rproductId = _positionSanitary.find("#_productId").val();
        var _rpharmaFormid = _positionSanitary.find("#_pharmaformId").val();
        var _rcategoryId = _positionSanitary.find("#_categoryId").val();
        var _rdivisionId = _positionSanitary.find("#_divisionId").val();
        if (_getsanitary.trim() == false) {
            _positionSanitary.find("#_plusRegister").removeClass("hide");
            _positionSanitary.find("#_pencilRegister").addClass("hide");
        }
        if (_getsanitary.trim() != false) {
            _positionSanitary.find("#_plusRegister").addClass("hide");
            _positionSanitary.find("#_pencilRegister").removeClass("hide");
        }
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Sales/saveSanitary")",
            traditional: true,
            data: {
                ProductId: _rproductId,
                PharmaFormId: _rpharmaFormid,
                Categoryid: _rcategoryId,
                DivisionId: _rdivisionId,
                SanitaryRegister: _getsanitary
            },
            success: function (data) {
                swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                $("._modalSanitary").modal("hide");
            }
        });
    }
</script>

@*Fracción*@
<script>
    var _positionFraction;
    function _getFraction(item) {
        var tr = $(item).parents("tr:first");
        _positionFraction = tr;
        var _getproductName = tr.find("#_productName").text();
        var _getpharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _getcategoryName = tr.find("#_categoryName").text();
        var _getFraction = tr.find("#_fraction").text();
        $("#_messageFraction").empty();
        $("#_messageFraction").append("Agregue la Fracción Cofepris");
        $("#_addFraction").removeClass("hide");
        $("#_saveFraction").addClass("hide");
        $("#_fproductName").empty();
        $("#_fproductName").append(_getproductName);
        $("#_fpharmaceuticalForm").empty();
        $("#_fpharmaceuticalForm").append(_getpharmaceuticalForm);
        $("#_fcategoryName").empty();
        $("#_fcategoryName").append(_getcategoryName);
        $("#_setFraction").val(_getFraction);
    }
</script>
<script>
    var _positionFraction;
    function _fractionPencil(item) {
        var tr = $(item).parents("tr:first");
        _positionFraction = tr;
        var _getproductName = tr.find("#_productName").text();
        var _getpharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _getcategoryName = tr.find("#_categoryName").text();
        var _getFraction = tr.find("#_fraction").text();
        $("#_messageFraction").empty();
        $("#_messageFraction").append("Modifique la Fracción Cofepris");
        $("#_addFraction").addClass("hide");
        $("#_saveFraction").removeClass("hide");
        $("#_fproductName").empty();
        $("#_fproductName").append(_getproductName);
        $("#_fpharmaceuticalForm").empty();
        $("#_fpharmaceuticalForm").append(_getpharmaceuticalForm);
        $("#_fcategoryName").empty();
        $("#_fcategoryName").append(_getcategoryName);
        $("#_setFraction").val(_getFraction);
    }
</script>
<script>
    function _saveFraction(item) {
        var _getFraction = $("#_setFraction").val();
        _positionFraction.find("#_fraction").empty();
        _positionFraction.find("#_fraction").append(_getFraction);
        var _fproductId = _positionFraction.find("#_productId").val();
        var _fpharmaFormid = _positionFraction.find("#_pharmaformId").val();
        var _fcategoryId = _positionFraction.find("#_categoryId").val();
        var _fdivisionId = _positionFraction.find("#_divisionId").val();

        if (_getFraction.trim() == false) {
            _positionFraction.find("#_plusFraction").removeClass("hide");
            _positionFraction.find("#_fractionPencil").addClass("hide");
        }
        if (_getFraction.trim() != false) {
            _positionFraction.find("#_plusFraction").addClass("hide");
            _positionFraction.find("#_fractionPencil").removeClass("hide");
        }
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Sales/saveFraction")",
            traditional: true,
            data: {
                ProductId: _fproductId,
                PharmaFormId: _fpharmaFormid,
                Categoryid: _fcategoryId,
                DivisionId: _fdivisionId,
                Fraction: _getFraction
            },
            success: function (data) {
                swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                $('._modalFraction').modal('hide');
            }
        });
    }
</script>

@*Producto Nuevo*@
<script>
    // desmarcar __chargeOrthographic, _changes
    function _new(item) {
        var tr = $(item).parents("tr:first");
        var _productId = tr.find("#_productId").val();
        var _pharmaformId = tr.find("#_pharmaformId").val();
        var _categoryId = tr.find("#_categoryId").val();
        var _divisionid = tr.find("#_divisionId").val();
        if (tr.find("#_new").is(":checked")) {
            tr.find("#_changes").prop("checked", false);
            tr.find("#_chargeOrthographic").prop("checked", false);
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Sales/itsNew")",
                traditional: true,
                data: {
                    ProductId: _productId,
                    PharmaFormId: _pharmaformId,
                    Categoryid: _categoryId,
                    DivisionId: _divisionid
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
        else if (tr.find("#_new").is(":not(:checked)")) {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Sales/notNew")",
                traditional: true,
                data: {
                    ProductId: _productId,
                    PharmaFormId: _pharmaformId,
                    Categoryid: _categoryId,
                    DivisionId: _divisionid
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
    }
</script>

@*ProducCambio Ortográfico*@
<script>
    // desmarcar __chargeOrthographic, _new
    function _changes(item) {
        var tr = $(item).parents("tr:first");
        var _productId = tr.find("#_productId").val();
        var _pharmaformId = tr.find("#_pharmaformId").val();
        var _categoryId = tr.find("#_categoryId").val();
        var _divisionid = tr.find("#_divisionId").val();
        if (tr.find("#_changes").is(":checked")) {
            tr.find("#_new").prop("checked", false);
            tr.find("#_chargeOrthographic").prop("checked", false);
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Sales/withChanges")",
                traditional: true,
                data: {
                    ProductId: _productId,
                    PharmaFormId: _pharmaformId,
                    Categoryid: _categoryId,
                    DivisionId: _divisionid
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
        else if (tr.find("#_changes").is(":not(:checked)")) {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Sales/withoutChanges")",
                traditional: true,
                data: {
                    ProductId: _productId,
                    PharmaFormId: _pharmaformId,
                    Categoryid: _categoryId,
                    DivisionId: _divisionid
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
    }
</script>



<script>
    // desmarcar _new, _changes
    function _chargeOrthographic(item) {
        var tr = $(item).parents("tr:first");
        var _productId = tr.find("#_productId").val();
        var _pharmaformId = tr.find("#_pharmaformId").val();
        var _categoryId = tr.find("#_categoryId").val();
        var _divisionid = tr.find("#_divisionId").val();
        if (tr.find("#_chargeOrthographic").is(":checked")) {
            tr.find("#_new").prop("checked", false);
            tr.find("#_changes").prop("checked", false);
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Production/withOrthographicChanges")",
                traditional: true,
                data: {
                    ProductId: _productId,
                    PharmaFormId: _pharmaformId,
                    Categoryid: _categoryId,
                    DivisionId: _divisionid
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
        else if (tr.find("#_chargeOrthographic").is(":not(:checked)")) {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Production/withoutOrthographicChanges")",
                traditional: true,
                data: {
                    ProductId: _productId,
                    PharmaFormId: _pharmaformId,
                    Categoryid: _categoryId,
                    DivisionId: _divisionid
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
    }
</script>
<script>
    var _positionItem;
    function _getItem(item) {
        var tr = $(item).parents("tr:first");
        _positionItem = tr;
        var _iProductName = tr.find("#_productName").text();
        var _iPharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _iCategoryName = tr.find("#_categoryName").text();
        $("#_itproductName").empty();
        $("#_itproductName").append(_iProductName);
        $("#_itpharmaceuticalForm").empty();
        $("#_itpharmaceuticalForm").append(_iPharmaceuticalForm);
        $("#_itcategoryName").empty();
        $("#_itcategoryName").append(_iCategoryName);
        $("#_elementItems tbody").empty();
        var _iProductId = tr.find("#_productId").val();
        var _iPharmaformId = tr.find("#_pharmaformId").val();
        var _iCategoryId = tr.find("#_categoryId").val();
        var _iDivisionId = tr.find("#_divisionId").val();
        var _iEditionId = $("#_editionId").val();
        var _iCountryId = $("#_countryId").val();
        var _iBookId = $("#_bookId").val();
        $("#_elementAttributes tbody").empty();
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Production/getAtributes")",
            traditional: true,
            data: {
                CountryId: _iCountryId,
                BookId: _iBookId,
                EditionId: _iEditionId,
                ProductId: _iProductId,
                PharmaFormId: _iPharmaformId,
                Categoryid: _iCategoryId,
                DivisionId: _iDivisionId
            },
            success: function (data) {
                if (data == false) {
                    $("#_elementAttributes tbody").append(
                        "<tr id='_itemNull'>"
                        + "<td align='center'>" + "Sin rubros" + "</td>"
                        + "<td></td>"
                        + "</tr>"
                        );
                }
                else {
                    $.each(data, function (index, item) {
                        if (item.check == "true") {
                            var _checked = "checked";
                        }
                        $("#_elementAttributes tbody").append(
                            "<tr>"
                            + "<td align='center'>" + "<span id='_atributeName'>" + item.AttributeGroupName + "</span>" + "</td>"
                            + "<td align='center'>"
                            + " <input type='hidden' id='_vlattributeId' value='" + item.AttributeGroupId + "'>"
                            + "<input id='_checkAttributes' onclick='_setAttributes($(this))' type='checkbox' " + _checked + ">"
                            + "</td>"
                            + "</tr>"
                            );
                    });
                }
            }
        });
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Production/getItems")",
            traditional: true,
            data: {
                EditionId: _iEditionId,
                ProductId: _iProductId,
                PharmaFormId: _iPharmaformId,
                Categoryid: _iCategoryId,
                DivisionId: _iDivisionId
            },
            success: function (data) {
                if (data == false) {
                    $("#_elementItems tbody").append(
                        "<tr id='_itemNull'>"
                        + "<td align='center'>" + "Sin rubros" + "</td>"
                        + "</tr>"
                        );
                }
                else {
                    $.each(data, function (index, item) {
                        $("#_elementItems tbody").append(
                            "<tr>"
                            + "<td align='center'>" + "<span> " + item.AttributeGroupName + "</span>" + "</td>"
                            + "</tr>"
                            );
                    });
                }
            }
        });
    }
    function _closeModal(item) {
        $("._modalItem").removeClass("modalLeft");
        $('._modalIpp').modal('hide');
    }
    function _closeIpp(item) {
        $("._modalItem").removeClass("modalLeft");
    }
</script>
<script>
    function _setAttributes(item) {
        var tr = $(item).parents("tr:first");
        var _getAttributeGroupName = tr.find("#_atributeName").text();
        var _vlAttribute = tr.find("#_vlattributeId").val();
        if (tr.find("#_checkAttributes").is(":checked")) {
            $('#_elementItems > tbody  > tr').each(function (tr) {
                var _getAttributes = $(this).text();
                if (_getAttributes == "Sin rubros") {
                    $(this).remove();
                }
            })
            $("#_elementItems tbody").append(
                "<tr>"
                + "<td align='center'><span>" + _getAttributeGroupName + "</span>" + "</td>"
                + "</tr>"
                );
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Production/saveAttributeGroup")",
                traditional: true,
                data: {
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }
        else if (tr.find("#_checkAttributes").is(":not(:checked)")) {
            $('#_elementItems > tbody  > tr').each(function (tr) {
                var _getAttributes = $(this).text();
                if (_getAttributes.trim() == _getAttributeGroupName.trim()) {
                    $(this).remove();
                }
            });
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "@Url.Content("~/Production/removeAttributeGroup")",
                traditional: true,
                data: {
                },
                success: function (data) {
                    swal({ title: "¡Cambios guardados!", type: "success", text: "", timer: 1000, });
                }
            });
        }

    }
</script>
<script>
    function _showIpp(item) {
        $("._modalItem").addClass("modalLeft");
        $("#_contentIpp").empty();
        var _iaProductId = _positionItem.find("#_productId").val();
        var _iaPharmaformId = _positionItem.find("#_pharmaformId").val();
        var _iaCategoryId = _positionItem.find("#_categoryId").val();
        var _iaDivisionId = _positionItem.find("#_divisionId").val();
        var _iaEditionId = $("#_editionId").val();
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Production/getIpp")",
            traditional: true,
            data: {
                EditionId: _iaEditionId,
                ProductId: _iaProductId,
                PharmaFormId: _iaPharmaformId,
                Categoryid: _iaCategoryId,
                DivisionId: _iaDivisionId
            },
            success: function (data) {
                if (data == false) {
                    $("#_contentIpp").append("Sin contenido");
                }
                else {
                    $.each(data, function (index, item) {
                        $("#_contentIpp").append(item.HTMLContent)
                    });
                }
            }
        });
    }
</script>
<script>
    $(document).ready(function () {
        $('#_charEdition').keyup(function () {
            var valThis = $(this).val().toLowerCase();
            $('.searchEdition').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) == 0) ? $(this).show() : $(this).hide();
            });
        });
    });
</script>
<script>
    $(document).ready(function () {
        $('#_charLab').keyup(function () {
            var valThis = $(this).val().toLowerCase();
            $('.searchLab').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) == 0) ? $(this).show() : $(this).hide();
            });
        });
    });
</script>
<script>
    $(document).ready(function () {
        $(".report").click(function () {
            swal({
                imageUrl: "@Url.Content("~/Images/generando.gif")",
                title: "Generando Excel...",
                text: "Se descargará el archivo automáticamente.",
                timer: 3000,
            });
        });
    });
</script>

@*Línea de productos*@
<script>
    function _getProductLines(item) {
        var tr = $(item).parents("tr:first");
        var _productId = tr.find("#_productId").val();
        var _pharmaformId = tr.find("#_pharmaformId").val();
        var _categoryId = tr.find("#_categoryId").val();
        var _divisionid = tr.find("#_divisionId").val();
        var _getproductName = tr.find("#_productName").text();
        var _getpharmaceuticalForm = tr.find("#_pharmaceuticalForm").text();
        var _getcategoryName = tr.find("#_categoryName").text();
        $("#_lproductName").empty();
        $("#_lproductName").append(_getproductName);
        $("#_lpharmaceuticalForm").empty();
        $("#_lpharmaceuticalForm").append(_getpharmaceuticalForm);
        $("#_lcategoryName").empty();
        $("#_lcategoryName").append(_getcategoryName);
        $("#_elementTable tbody").empty();
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "@Url.Content("~/Sales/getProductLines")",
            traditional: true,
            data: {
                ProductId: _productId,
                PharmaFormId: _pharmaformId,
                Categoryid: _categoryId,
                DivisionId: _divisionid
            },
            success: function (data) {
                $.each(data, function (index, item) {
                    $("#_elementTable tbody").append(
                        "<tr>"
                        + "<td>" + item.ProductLine + "</td>"
                        );
                });
            }
        });
    }
</script>


<br />
<div class="row col-md-10">
    <div class="headergroup">
        <div class="title">
            <div class="title-word" style="font-weight:normal; text-transform:none">Medinet <span style="color:#de5347">v3.0</span></div>
            <div class="title-word" style="font-weight:normal; text-transform:none;"><strong style="color:#000000;">Ventas</strong> | Laboratorios y productos</div>
        </div>
    </div>
    <br />
    <nav style="background: rgba(233, 233, 233, 0.11); border-radius: 10px;" class="navbar navbar-default">
        <div style="margin-left: 15px;" class="container-fluid">
            <div class="navbar-header">
                <input type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                @{

                    CountriesUsers _CountriesUsers = (CountriesUsers)Session["CountriesUsers"];
                    if (_CountriesUsers.country.LongCount() >= 1)
                    {
                        <a href="@Url.Content("~/Sales/Index")" class="btn navbar-brand zindex" title="Filtros">
                            <i style="color:#b3dca1" class="glyphicon glyphicon-bookmark"></i>

                        </a>
                    }
                    else
                    {
                        <a href="@Url.Content("~/Production/FilterIndex/" + _Session.id)" class="btn navbar-brand zindex" title="Filtros">
                            <i style="color:#b3dca1" class="glyphicon glyphicon-bookmark"></i>
                        </a>
                    }
                }
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav hov">
                    <li style="background: rgba(233, 233, 233, 0.01);" class="dropdown navbar-default hov">
                        <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Ediciones<span style="margin-left: 5px; color: black; " class="caret"></span></a>
                        <ul class="dropdown-menu vertical" role="menu">
                            <li>
                                <div id="custom-search-input">
                                    <div class="input-group col-md-11">
                                        <input id="_charEdition" type="text" class="form-control" placeholder="Buscar" />
                                    </div>
                                </div>
                            </li>
                            <li><p></p></li>
                            @{
                                var _getEditions = (from _e in db.Editions
                                                    where _e.BookId == _Session.ed
                                                    && _e.CountryId == _Session.id
                                                    orderby _e.NumberEdition descending
                                                    select _e).ToList();
                                foreach (var _row in _getEditions)
                                {
                                    <li class="searchEdition"><a class="zindex" href="@Url.Content("~/Sales/Content/" + @_row.CountryId + "/" + @_Session.ed + "/" + _row.EditionId + "/" + @_Session.ud)">@_row.NumberEdition</a></li>
                                }
                            }
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav hov">
                    <li style="background: rgba(233, 233, 233, 0.01);" class="dropdown navbar-default hov">
                        <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Laboratorios<span style="margin-left: 5px; color: black; " class="caret"></span></a>
                        <ul class="dropdown-menu vertical" role="menu">
                            <li>
                                <div id="custom-search-input">
                                    <div class="input-group col-md-11">
                                        <input id="_charLab" type="text" class="form-control" placeholder="Buscar" />
                                    </div>
                                </div>
                            </li>
                            <li><p></p></li>
                            @{
                                var _getDivisions = db.Database.SqlQuery<plm_spGetDivisionsByEditionByCountry_Result>("plm_spGetDivisionsByEditionByCountry @countryId=" + _Session.id + ",@editionId=" + _Session.ad).ToList();
                                foreach (var _row in _getDivisions)
                                {
                                    <li class="searchLab"><a class="zindex" href="@Url.Content("~/Sales/Content/" + @_row.CountryId + "/" + @_Session.ed + "/" + @_Session.ad + "/" + @_row.DivisionId)">@_row.DivisionName</a></li>
                                }
                            }
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav hov">
                    <li style="background: rgba(233, 233, 233, 0.01);" class="dropdown navbar-default hov">
                        <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Exportar productos<span style="margin-left: 5px; color: black" class="caret"></span></a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a class="report"><span class="glyphicon glyphiconr glyphicon glyphicon-export text-success"></span>Exportar a Excel</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a class="btn navbar-brand" title="Anterior" onclick="history.back();">
                            <i style="color:#324887" class="glyphicon glyphicon-arrow-left"></i>
                        </a>
                        <a class="btn navbar-brand" title="Siguiente" onclick="history.forward();">
                            <i style="color:#324887;" class="glyphicon glyphicon-arrow-right"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="qa-message-list col-md-12 col-xs-12" id="wallmessages">
        <div class="message-item" id="m16">
            <div class="message-inner">
                <div class="avatar pull-left"></div>
                <div class="user-detail">
                    <div class="post-meta">
                        <div class="asker-meta">
                            <div class="title_new" align="left">
                                <div class="title-word_new">
                                    <p>
                                        <span class="qa-message-when-data" style="font-size:18px; text-transform:none; font-weight:normal;">País: <span style="color: #de5145">@ViewData["CountryName"]</span> </span>
                                        <input type="text" value="@CountryId" id="CountryId" style="display:none" />
                                    </p>
                                </div>
                            </div>
                            <div class="title_new" align="left">
                                <div class="title-word_new">
                                    <p>
                                        <span class="qa-message-when-data" style="font-size:18px; text-transform:none; font-weight:normal;">Obra: <span style="color: #de5145">@ViewData["BookName"]</span> </span>
                                        <input type="text" value="@BookId" id="BookId" style="display:none" />
                                    </p>
                                </div>
                            </div>
                            <div class="title_new" align="left">
                                <div class="title-word_new">
                                    <p>
                                        <span class="qa-message-when-data" style="font-size:18px; text-transform:none; font-weight:normal;">Edición: <span style="color: #de5145">@ViewData["EditionNumber"]</span> </span>
                                        <input type="text" value="@EditionId" id="EditionId" style="display:none" />
                                    </p>
                                </div>
                            </div>
                            <div class="title_new" align="left">
                                <div class="title-word_new">
                                    <p>
                                        <span class="qa-message-when-data" style="font-size:18px; text-transform:none; font-weight:normal;">Versión: <span style="color: #de5145">@ViewData["TypeName"]</span> </span>
                                    </p>
                                </div>
                            </div>
                            <div class="title_new">
                                <div class="title-word_new">
                                    <p>
                                        <span class="qa-message-when-data" style="font-size: 18px; text-transform: none; font-weight: normal;">Laboratorio: <span style="color: #de5145; ">@ViewData["DivisionName"]</span></span>
                                        <input type="text" value="@DivisionId" id="DivisionId" style="display:none" />
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br />
<div style="width:0;" class="col-md-1"></div>
<div class="row col-md-2">
    <br />
    <div class="title_new">
        <div class="title-word_new">
            <div class="well well-white mini-profile-widget">
                <div class="image-container" align="center">
                    <img src="@Url.Content("~/Images/no.png")" class="img-responsive" alt="avatar">
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/DataTables/jqueryDataTablesProducts.js"></script>
<script src="~/Scripts/DataTables/dataTables.scroller.min.js"></script>
<script src="~/Scripts/DataTables/dataTables.bootstrap.js"></script>
<link href="~/Content/DataTables/css/dataTables.bootstrap.css" rel="stylesheet" />
<script>
    $(document).ready(function () {
        $(document).ready(function () {
            $('#example').dataTable({
                "columnDefs": [{ "searchable": false, "targets": [1, 2] }],
                "language": {
                    "lengthMenu": "<div class='col-md-3 title_filter'>" +
                        "<div class='title-word' style='font-weight:normal; text-transform:none; font-size:17px;'> Mostrar <select class='form-control input-sm'> </div>" +
                      '<option value="10">10</option>' +
                      '<option value="20">20</option>' +
                      '<option value="30">30</option>' +
                      '<option value="40">40</option>' +
                      '<option value="50">50</option>' +
                      '<option value="-1">Todo</option>' +
                      '</select> productos' + '</div>'
                }
            });
        });
    });
</script>
<input type="hidden" id="_countryId" value="@_Session.id" />
<input type="hidden" id="_bookId" value="@_Session.ed" />
<input type="hidden" id="_editionId" value="@_Session.ad" />
<br />

<div class="row col-md-12">
    <div class="col-lg-2">
        <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#addproduct" onclick="getpharmaformstoaddproduct($(this))">
            <span class="glyphicon glyphicon-plus"></span>
            <span>&nbsp; Agregar Producto</span>
        </button>
    </div>
    <div class="col-lg-3">
        <button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#addpharmaform" onclick="getproductstoaddpf()" id="addpharmaformbtn">
            <span class="fa fa-plus-square"></span>
            <span>&nbsp; Agregar Forma Farmacéutca</span>
        </button>
    </div>
    <div class="col-lg-2">
        <button class="btn btn-primary btn-sm ldr" onclick="location.href='@Url.Action("LaboratoryInformation", "Sales", new { Division = DivisionId })';return false;">
            <span class=" glyphicon glyphicon-edit">
            </span>
            <span>&nbsp; Editar Laboratorio</span>
        </button>
    </div>
    <div class="col-lg-3">
        <button class="btn btn-primary btn-sm ldr" onclick="location.href='@Url.Action("ChangeProducts", "Sales", new { Division = DivisionId, CountryId = CountryId })';return false;">
            <span class="glyphicon glyphicon-refresh"></span>
            <span>&nbsp; Cambiar Productos de Laboratorio</span>
        </button>
    </div>
</div>
<br />

<div class="row col-md-12" align="center">
    <span class="Titles">Productos</span>
</div>
<br />

<div class="row col-md-12 table-responsive">
    <table style="font-size:14px;" id="example" class="display table table-bordered table-hover" cellspacing="0">
        <thead>
            <tr>
                <td align="center" style="vertical-align:middle" class="tdback">Producto</td>
                <td align="center" style="vertical-align:middle" class="tdback">Forma farmaceútica</td>
                <td align="center" style="vertical-align:middle" class="tdback">Categoría</td>
                <td align="center" style="vertical-align:middle" class="tdback">Descripción</td>
                <td align="center" style="vertical-align:middle" class="tdback">Tipo de producto</td>
                <td align="center" style="vertical-align:middle" class="tdback">Fabricante</td>
                <td align="center" style="vertical-align:middle" class="tdback">Distribuidor</td>
                <td align="center" style="vertical-align:middle" class="tdback">línea de producto</td>
                <td align="center" style="vertical-align:middle" class="tdback">Edición</td>
                <td align="center" style="vertical-align:middle" class="tdback">Participante</td>
                <td align="center" style="vertical-align:middle" class="tdback">Nuevo</td>
                <td align="center" style="vertical-align:middle" class="tdback">Cambio fondos</td>
                <td align="center" style="vertical-align:middle" class="tdback">Cambio ortográfico</td>
                <td align="center" style="vertical-align:middle" class="tdback">SIDEF</td>
                <td width="100" align="center" style="vertical-align:middle" class="tdback">Registro sanitario</td>
                <td width="70" align="center" style="vertical-align:middle" class="tdback">Fracción cofepris</td>
                <td align="center" style="vertical-align:middle" class="tdback">Fuera del mercado</td>
                <td align="center" style="vertical-align:middle" class="tdback">VMG</td>
                <td align="center" style="vertical-align:middle" class="tdback">Editar</td>

            </tr>
        </thead>
        <tbody>
            @{
                foreach (var _row in Model)
                {
                    <tr>
                        <td align="center"><span id="_productName">@_row.Brand</span> <input type="hidden" id="_divisionId" value="@_row.DivisionId" /> <input type="hidden" id="_productId" value="@_row.ProductId" /></td>
                        <td align="center"><span id="_pharmaceuticalForm">@_row.PharmaForm</span>  <input type="hidden" id="_pharmaformId" value="@_row.PharmaFormId" /></td>
                        <td align="center"><span id="_categoryName">@_row.CategoryName</span> <input type="hidden" id="_categoryId" value="@_row.CategoryId" /></td>
                        <td align="center">@_row.ProductDescription</td>
                        <td align="center">@_row.ProductType</td>
                        <td align="center"><span id="laboratoryName">@_row.LaboratoryName</span> <input type="hidden" id="_divisionId" value="@_row.DivisionId" /> <input type="hidden" id="_laboratoryId" value="@_row.LaboratoryId" /></td>
                        <td align="center"><span id="_distributorName">Distribuidor</span> <input type="hidden" id="_divisionId" value="@_row.DivisionId" /> <input type="hidden" id="_productId" /></td>
                        @*Linea de producto*@
                        <td align="center"><a onclick="_getProductLines($(this))" data-toggle="modal" data-target="._modalProductLine" class="btn btn-primary  btn-sm loading"><span class="glyphicon glyphicon-indent-right"></span></a></td>
                        @*Edición*@
                        <td align="center"><a onclick="_getParticipant($(this))" data-toggle="modal" data-target="._modalProducts" class="btn btn-primary  btn-sm loading"><span class="glyphicon glyphicon-indent-right"></span></a></td>
                        @*Participante*@
                        <td align="center">
                            @{
                    var Participant = _row.Participant;
                    if (Participant > 0)
                    {
                        <input checked id="_new" onclick="_participant($(this))" class="true" type="checkbox" />
                    }
                    else
                    {
                        <input id="_new" onclick="_participant($(this))" class="true" type="checkbox" />
                    }
                            }
                        </td>

                        @*Nuevo*@
                        <td align="center">
                            @{
                    var NewProduct = _row.NewProduct;
                    if (NewProduct > 0)
                    {
                        <input checked id="_new" onclick="_new($(this))" class="true" type="checkbox" />
                    }
                    else
                    {
                        <input id="_new" onclick="_new($(this))" class="true" type="checkbox" />
                    }
                        }
                    </td>
                    @*Cambio fondos*@
                    <td align="center">
                        @{
                    byte ContentTypeId = ct_co[0].ContentTypeId;
                    var CTId = _row.ModifiedContent;
                    if (CTId == ContentTypeId)
                    {
                        <input checked id="_changes" onclick="_changes($(this))" class="true" type="checkbox" />
                    }
                    else
                    {
                        <input id="_changes" onclick="_changes($(this))" class="true" type="checkbox" />
                    }
                        }
                    </td>
                    @*Cambio ortográfico*@
                    <td align="center">
                        @{
                    byte ContentTypeIdd = ct_cf[0].ContentTypeId;
                    var CTIdcf = _row.ModifiedContent;
                    if (CTIdcf == ContentTypeIdd)
                    {
                        <input checked id="_changes" onclick="_changes($(this))" class="true" type="checkbox" />
                    }
                    else
                    {
                        <input id="_changes" onclick="_changes($(this))" class="true" type="checkbox" />
                    }
                        }
                    </td>

                    @*SIDEF*@
                    <td align="center">
                        @{
                    var SIDEF = _row.Sidef;
                    if (SIDEF > 0)
                    {
                        <input checked id="_changes" class="true" type="checkbox" />
                    }
                    else
                    {
                        <input id="_changes" class="true" type="checkbox" />
                    }
                        }
                    </td>
                    @*Registro sanitario*@
                    <td align="right">
                        @{
                    if (_row.SanitaryRegister == null)
                    {
                        <span id="_sanitaryRegister" style="margin-right:10px;"></span><button id="_plusRegister" onclick="_plusRegister($(this))" data-toggle="modal" data-target="._modalSanitary" class="btn btn-success  btn-sm loading"><i class="glyphicon glyphicon-plus"></i></button>
                            <button id="_pencilRegister" onclick="_getSanitary($(this))" data-toggle="modal" data-target="._modalSanitary" class="btn btn-default  btn-sm loading hide"><i class="glyphicon glyphicon-pencil"></i></button>
                    }
                    else
                    {
                        <span id="_sanitaryRegister" style="margin-right:10px;">@_row.SanitaryRegister</span><button id="_plusRegister" onclick="_plusRegister($(this))" data-toggle="modal" data-target="._modalSanitary" class="btn btn-success  btn-sm loading hide"><i class="glyphicon glyphicon-plus"></i></button>
                            <button id="_pencilRegister" onclick="_getSanitary($(this))" data-toggle="modal" data-target="._modalSanitary" class="btn btn-default  btn-sm loading"><i class="glyphicon glyphicon-pencil"></i></button>
                    }
                        }
                    </td>

                    @*Fracción cofepris*@
                    <td align="right">
                        @{
                    if (_row.SSFraction == null)
                    {
                        <span id="_fraction" style="margin-right:10px;"></span><button id="_plusFraction" onclick="_getFraction($(this))" data-toggle="modal" data-target="._modalFraction" class="btn btn-success  btn-sm loading"><i class="glyphicon glyphicon-plus"></i></button>
                            <button id="_fractionPencil" onclick="_fractionPencil($(this))" data-toggle="modal" data-target="._modalFraction" class="btn btn-default  btn-sm loading hide"><i class="glyphicon glyphicon-pencil"></i></button>
                    }
                    else
                    {
                        <span id="_fraction" style="margin-right:10px;">@_row.SSFraction</span><button id="_plusFraction" onclick="_getFraction($(this))" data-toggle="modal" data-target="._modalFraction" class="btn btn-success  btn-sm loading hide"><i class="glyphicon glyphicon-plus"></i></button>
                            <button id="_fractionPencil" onclick="_fractionPencil($(this))" data-toggle="modal" data-target="._modalFraction" class="btn btn-default  btn-sm loading"><i class="glyphicon glyphicon-pencil"></i></button>
                    }
                        }
                    </td>

                    @*OffMarket*@

                    <td align="center"> <input checked id="_new" class="true" type="checkbox" /></td>
                    <td align="center"><span id="_genericBrand"></span> <input type="hidden" id="_divisionId" value="@_row.DivisionId" /> <input type="hidden" id="_productId" value="@_row.ProductId" /></td>

                    <td align="center"><a data-toggle="modal" class="btn btn-primary  btn-sm loading"><span class="glyphicon glyphicon-pencil"></span></a></td>

                </tr>
                }
            }
        </tbody>
    </table>
</div>


@*Modal Ediciones participantes*@
<div class="modal fade _modalProducts" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #2184be">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 style="font-size: 18px; color: white" class="modal-title" id="myModalLabel" align="center"> <span>Ediciones</span></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div style="padding-top:18px;" class="qa-message-list col-md-8" id=" wallmessages">
                        <div class="message-item" id="m16">
                            <div class="message-inner">
                                <div class="avatar pull-left"></div>
                                <div class="user-detail">
                                    <p style="padding-left:18px;">
                                        <span class="qa-message-when-data" style="font-size: 16px; text-transform: none; font-weight: normal;">Producto: <span id="_wproductName" style="color: #de5145;"></span></span>
                                    </p>
                                    <p style="padding-left:18px;">
                                        <span class="qa-message-when-data" style="font-size: 16px; text-transform: none; font-weight: normal;">Forma farmacéutica: <span id="_wpharmaceuticalForm" style="color: #de5145;"></span></span>
                                    </p>
                                    <p style="padding-left:18px;">
                                        <span class="qa-message-when-data" style="font-size: 16px; text-transform: none; font-weight: normal;">Categoría: <span id="_wcategoryName" style="color: #de5145;"></span></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="well well-white mini-profile-widget col-md-3">
                        <div class="image-container" align="center">
                            <img src="@Url.Content("~/Images/ediciones.png")" class="img-responsive" alt="avatar">
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                </div>
                <div align="center">
                    <span style="font-size:18px;">Participaciones</span>
                </div>
                <br />
                <div class="table-responsive">
                    <table id="_elementTable" class="table table-bordered table-hover">
                        <thead>
                            <tr style=" box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);">
                                <td class="tdback">Obra</td>
                                <td class="tdback">Edición</td>
                                <td class="tdback">Tipo de edición</td>
                                <td class="tdback">Versión</td>
                                <td class="tdback">Obra de la que emana</td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer" align="center">
                <div align="center">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>

@*Modal Lineas de producto*@
<div class="modal fade _modalProductLine" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #2184be">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 style="font-size: 18px; color: white" class="modal-title" id="myModalLabel" align="center"> <span>Líneas</span></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div style="padding-top:18px;" class="qa-message-list col-md-8" id=" wallmessages">
                        <div class="message-item" id="m16">
                            <div class="message-inner">
                                <div class="avatar pull-left"></div>
                                <div class="user-detail">
                                    <p style="padding-left:18px;">
                                        <span class="qa-message-when-data" style="font-size: 16px; text-transform: none; font-weight: normal;">Producto: <span id="_lproductName" style="color: #de5145;"></span></span>
                                    </p>
                                    <p style="padding-left:18px;">
                                        <span class="qa-message-when-data" style="font-size: 16px; text-transform: none; font-weight: normal;">Forma farmacéutica: <span id="_lpharmaceuticalForm" style="color: #de5145;"></span></span>
                                    </p>
                                    <p style="padding-left:18px;">
                                        <span class="qa-message-when-data" style="font-size: 16px; text-transform: none; font-weight: normal;">Categoría: <span id="_lcategoryName" style="color: #de5145;"></span></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="well well-white mini-profile-widget col-md-3">
                        <div class="image-container" align="center">
                            <img src="@Url.Content("~/Images/ediciones.png")" class="img-responsive" alt="avatar">
                        </div>
                    </div>
                    <div class="col-md-1"></div>
                </div>
                <div align="center">
                    <span style="font-size:18px;">Líneas de Producto</span>
                </div>
                <br />
                <div class="table-responsive">
                    <table id="_elementTable" class="table table-bordered table-hover">
                        <thead>
                            <tr style=" box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);">
                                <td class="tdback">Línea de producto</td>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer" align="center">
                <div align="center">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
</div>

@*Modal agregar producto*@
<div class="modal fade" id="addproduct" role="dialog" aria-labelledby="myLargeModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #2184be">
                <button type="button" class="close" data-dismiss="modal" onclick="cancelcreateproduct()">&times;</button>
                <h4 style="font-size: 18px; color: white" class="modal-title" id="myModalLabel" align="center"> <span>Agregar Producto</span></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-lg-12">
                        <table border="0" class="widthtable">
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Nombre de Producto:</label>
                                </td>
                                <td>
                                    <div class="form-group has-feedback" id="divProductName">
                                        <input type="text" placeholder="Nombre de Producto" class="form-control" id="txtProductName" onkeypress="$('#divProductName').removeClass('has-error'), $('.errorP').hide()" />
                                        <span class="glyphicon glyphicon-remove form-control-feedback errorP" style="display:none"></span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Forma Farmacéutica:</label>
                                </td>
                                <td>
                                    @{
                                        <div class="form-group has-feedback" id="divpfaddproduct">
                                            <select class="form-control" id="selectpfaddproduct" onchange="$('#divpfaddproduct').removeClass('has-error'), $('.errorPF').hide()">
                                                <option value="0" id="cat0">Seleccione...</option>
                                                @{
                                                    var ff = db.PharmaceuticalForms.Where(x => x.Active == true).OrderBy(x => x.Description).ToList();
                                                    foreach (PharmaceuticalForms _ff in ff)
                                                    {
                                                        <option value="@_ff.PharmaFormId">@_ff.Description</option>
                                                    }
                                                }
                                            </select>
                                            <span class="glyphicon glyphicon-remove form-control-feedback errorPF" style="display:none"></span>
                                        </div>
                                    }
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label class="labels">Categoría:</label>
                                </td>
                                <td>
                                    <div class="form-group has-feedback" id="divCategories">
                                        <select class="form-control" id="Categories" onchange="$('#divCategories').removeClass('has-error'), $('.errorC').hide()">
                                            <option value="0" id="cat0">Seleccione...</option>
                                            @{
                                                var c = db.Categories.Where(x => x.Active == true).OrderBy(x => x.Description).ToList();
                                                foreach (Categories _c in c)
                                                {
                                                    <option value="@_c.CategoryId">@_c.Description</option>
                                                }
                                            }
                                        </select>
                                        <span class="glyphicon glyphicon-remove form-control-feedback errorC" style="display:none"></span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Tipo de Producto:</label>
                                </td>
                                <td>
                                    <div class="form-group has-feedback" id="divProductTypes">
                                        <select class="form-control" id="ProductTypes" onchange="$('#divProductTypes').removeClass('has-error'), $('.errorPT').hide()">
                                            <option value="null" id="ptnull">Seleccione...</option>
                                            @{
                                                var pt = db.ProductTypes.OrderBy(x => x.TypeName).ToList();
                                                foreach (ProductTypes _pt in pt)
                                                {
                                                    <option value="@_pt.ProductTypeId">@_pt.TypeName</option>
                                                }
                                            }
                                        </select>
                                        <span class="glyphicon glyphicon-remove form-control-feedback errorPT" style="display:none"></span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Descripción:</label>
                                </td>
                                <td>
                                    <textarea class="form-control" placeholder="Descripción" id="Pdescription"></textarea>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Registro Sanitario:</label>
                                </td>
                                <td>
                                    <input class="form-control" placeholder="Registro Sanitario" id="Regsanitary" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Fracción COFEPRIS:</label>
                                </td>
                                <td>
                                    <input class="form-control" placeholder="Fracción COFEPRIS" id="COFEPRIS" />
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer" id="divbtnclose">
                <button type="button" class="btn btn-primary" id="insertproduct" onclick="createproduct()">
                    <span class="glyphicon glyphicon-save"></span>
                    <span>&nbsp; Guardar</span>
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal" id="btnClose">
                    <span class="glyphicon glyphicon-remove"></span>
                    <span>&nbsp; Cancelar</span>
                </button>
            </div>
        </div>
    </div>
</div>

@*Modal agregar forma farmaceutica*@
<div class="modal fade" id="addpharmaform" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header label-primary">
                <button type="button" class="close" data-dismiss="modal" onclick="canceladdpharmaformtoproduct()">&times;</button>
                <h3 class="modal-title" style="color:white"><i>Agregar Forma Farmacéutica</i></h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-lg-12">
                        <table border="0" class="widthtable">
                            <tr>
                                <td style="width:25%">
                                    <label class="labels">Nombre de Producto:</label>
                                </td>
                                <td>
                                    <select class="form-control" id="selectproduct" onchange="getpharmaformswithoutproducts($(this).val())"></select>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <br />
                                </td>
                            </tr>
                            <tr>
                                <td style="width: 25%; display: none" class="trpharmaform">
                                    <label class="labels">Forma Farmacéutica:</label>
                                </td>
                                <td style="display: none" class="trpharmaform">
                                    @{
                                        <select class="form-control" id="selectpharmaform" onchange="$(savepharmaformtoproduct).show()"></select>
                                    }
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer" id="divbtnclose">
                <button type="button" class="btn btn-primary" id="savepharmaformtoproduct" style="display:none" onclick="addpharmaformtoproduct()">
                    <span class="glyphicon glyphicon-save"></span>
                    <span>&nbsp; Guardar</span>
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal" id="btnClose" onclick="canceladdpharmaformtoproduct()">
                    <span class="glyphicon glyphicon-remove"></span>
                    <span>&nbsp; Cancelar</span>
                </button>
            </div>
        </div>
    </div>
</div>
