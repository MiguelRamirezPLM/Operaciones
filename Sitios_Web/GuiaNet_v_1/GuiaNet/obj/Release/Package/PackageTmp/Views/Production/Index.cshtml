@model IEnumerable<GuiaNet.Models.Products>
@using GuiaNet.Models;
@{
    ViewBag.Title = "Index";
    WebGrid _datagrid = new WebGrid(Model, rowsPerPage: 20);
    Guia db = new Guia();
    sessionproduction ind = (sessionproduction)Session["sessionproduction"];

    int ClientIdss, EditionIds, BookIds, CountryIdss;
    if (ind != null)
    {
        ClientIdss = ind.ClId;
        EditionIds = ind.EId;
        BookIds = ind.BId;
        CountryIdss = ind.CId;
    }
    else
    {
        ClientIdss = 0;
        EditionIds = 0;
        BookIds = 0;
        CountryIdss = 0;
    }
}

<html>
<head>
    <title></title>

    <script src="http://malsup.github.com/jquery.form.js"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/apprise-1.5.min.js")"></script>
    <link rel="stylesheet" href="~/Content/apprise.min.css" type="text/css" />
    <script>
        $(function () {
            $(".send").click(function () {
                $("#bloqueo").show();
                var tr = $(this).parents("tr:first");
                var p = tr.find("#lblProductidPe").val();
                var d = "";
                d += "<div align='center'><img src='../Images/alerta.png' /> </div>";

                tr.find("#sendimages").ajaxSubmit ({
                    type: "POST",
                    url: "../Production/newpdffile/",
                    data: { ProductId: p },
                    success: function (data) {
                        if (data == true) {
                            setTimeout('document.location.reload()');
                        }
                        else if (data == "El archivo se ha Modificado Exitosamente") {
                            d += "<p> </p>"
                            d += "<li style='text-align:justify;color:#05606d;font-style:italic'>" + data + "</li>"
                            apprise("" + d + "", { 'animate': true });
                            $(".edit-mode").hide();
                            $(".display-mode").show();
                            $("#bloqueo").hide();
                        }
                    },
                });
            });
        });
    </script>

    <script>
        $(function () {
            $(".upload").change(function () {
                var tr = $(this).parents("tr:first");

                var uplbtn = tr.find("#uploadBtn").val();
                var ufile = tr.find("#uploadFile").val(uplbtn);
            })
        });
    </script>

    <script type="text/javascript">
        $(function () {
            $(".edit-mode").hide();
            $(".edit-user, .cancel-user").click(function (evento) {
                var tr = $(this).parents("tr:first");
                tr.find(".edit-mode, .display-mode").toggle();
            });
        });
    </script>

    <script>
        $(function () {
            $("#images").click(function () {
                $('#insertnewimage').fadeIn('slow');
                $('.popup-overlay').fadeIn('slow');
                $('.popup-overlay').height($(window).height());
                return false;
            })
        })
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('#close').click(function () {
                $('#insertnewimage').fadeOut('slow');
                $('.popup-overlay').fadeOut('slow');
                return false;
            });
        });
    </script>

    <script>
        $(function () {
            $(".imagess").click(function () {
                var tr = $(this).parents("tr:first");
                var ProdId = tr.find("#lblProductidPe").val();
                $.ajax({
                    type: "POST",
                    dataType: "json",
                    url: "../Production/images/",
                    traditional: true,
                    data: { product: ProdId },
                    success: function (data) {
                    }
                });
            })
        })
    </script>

    <script>
        $(function () {
            $(".imagesins").click(function () {
                $("#bloqueo").show();
            })
        })
    </script>

    <script>
        $(function () {
            $("#hetcatsproduction").click(function () {
                $("#hetcatsproduction").removeClass("labelout");
                $("#hetcatsproduction").addClass("labelin");
                $("#Productosprod").removeClass("labelin");
                $("#Productosprod").addClass("labelout");
                $("#hetcatproduction").show();
                $("#productsprod").hide();
            })
        })
    </script>

    <script>
        $(function () {
            $("#Productosprod").click(function () {
                $("#Productosprod").removeClass("labelout");
                $("#Productosprod").addClass("labelin");
                $("#hetcatsproduction").removeClass("labelin");
                $("#hetcatsproduction").addClass("labelout");
                $("#hetcatproduction").hide();
                $("#productsprod").show();
            })
        })
    </script>

    @*UPDATE PRODUCT FIELDS*@
    <script type="text/javascript">
        $(function () {
            $(".edit-modes").hide();
            $(".edit-users, .cancel-users").click(function (evento) {
                var tr = $(this).parents("tr:first");
                tr.find(".edit-modes, .display-modes").toggle();
            });

            $(".save-users").click(function (e) {
                var tr = $(this).parents("tr:first");
                var name = tr.find("#txtaName").val();
                var ID = tr.find("#lblClientId").val();
                var Pid = tr.find("#lblProductidPe").val();
                tr.find("#lblName").text(name);

                var d = "";
                d += "<div align='center'><img src='../Images/alerta.png' /> </div>";
                if ((!name.trim() == true)) {
                    apprise("<div align='center'><img src='../Images/alerta.png' /> </div>" + "Ningun campo puede quedar vacío", { 'animate': true });
                }
                else {
                    $("#bloqueo").show();
                    $.ajax({
                        type: "POST",
                        dataType: "Json",
                        url: "../Production/editproducts/",
                        traditional: true,
                        data: { ProductName: name, Product: Pid },
                        success: function (data) {
                            if (data == true) {
                                setTimeout('document.location.reload()');
                            }
                            if (data == false) {
                                apprise("<div align='center'><img src='../Images/alerta.png' /> </div>" + "&bull; El nombre de Producto, ya existe", { 'animate': true });
                            }
                        }
                    })
                }
                $("#bloqueo").hide();
            });
        });
    </script>
    @*END*@
</head>
<body>
    <style>
        .fileUpload {
            position: relative;
            overflow: hidden;
            margin: 10px;
        }

            .fileUpload input.upload {
                position: absolute;
                top: 0;
                right: 0;
                margin: 0;
                padding: 0;
                font-size: 20px;
                cursor: pointer;
                opacity: 0;
                filter: alpha(opacity=0);
            }

        .fileUploadhtml {
            position: relative;
            overflow: hidden;
            margin: 10px;
        }

            .fileUploadhtml input.uploadhtml {
                position: absolute;
                top: 0;
                right: 0;
                margin: 0;
                padding: 0;
                font-size: 20px;
                cursor: pointer;
                opacity: 0;
                filter: alpha(opacity=0);
            }
    </style>
    <br />
    <table border="0" style="width:100%; height:100%">
        <tr>
            <td colspan="4">
                <button style="float:right" id="" class="btn btn-info menul" onclick="location.href='@Url.Action("UserManualProd", "Help", new { module = "PROD" })';return false;">Ayuda</button>
                <ol class="breadcrumb">
                    <li><a href="/Production/Index">Producción</a></li>
                    <li class="active">Productos Participantes</li>
                </ol>
            </td>
        </tr>
        <tr>
            <td colspan="3">
                @using (Html.BeginForm())
                {
                <div style="text-align:right;display:none">
                    <p>
                        @{
                    if (ind != null)
                    {

                            <label>country</label><input id="CountryId" name="CountryId" type="text" value="@ind.CId">
                            <label>book</label><input id="BookId" name="BookId" type="text" value="@ind.BId">
                            <label>edition</label><input id="EditionId" name="EditionId" type="text" value="@ind.EId">
                            <label>client</label><input id="ClientId" name="ClientId" type="text" value="@ind.ClId">
                            <button type="submit" id="InsertParam" value="GridView" class="btn btn-primary" style="color: #333; width: 50px; font-size: 18px"></button>

                    }
                    else
                    {
                            <label>country</label><input id="CountryId" name="CountryId" type="text" value="">
                            <label>book</label><input id="BookId" name="BookId" type="text" value="">
                            <label>edition</label><input id="EditionId" name="EditionId" type="text" value="">
                            <label>client</label><input id="ClientId" name="ClientId" type="text" value="">
                            <button type="submit" id="InsertParam" value="GridView" class="btn btn-primary" style="color: #333; width: 50px; font-size: 18px"><img src="@Url.Content("~/Images/buscar.png")" style=" height:30px;width:30px;"></button>
                    }
                        }
                    </p>
                </div>
                }
                @{
                    if (ind == null)
                    {
                <div style="width: 100%; float: left">
                    <table style="width:100%" border="0">
                        <tr>
                            <td width="100px">
                                <label class="lblcountrywhite">País:</label><label style="color:red;float:right;font-size:20px">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <div style="text-align:left;">
                                    @using (Html.BeginForm())
                                            {
                                            <select name="pais" id="pais" onchange="getbook($(this).val());" class="country form-control" style="text-align: left; width: 100%; font-size: 12px; height: 30px;">
                                                <option class="null">Seleccione...</option>
                                                @{
                                                CountriesUsers p = (CountriesUsers)Session["CountriesUsers"];
                                                if (Session["CountriesUsers"] == null)
                                                {
                                                    Session.Abandon();
                                                    Response.Redirect(Url.Action("Logout", "Login"));
                                                    Response.End();
                                                }
                                                else if (p != null)
                                                {
                                                    List<string> d = p.var;
                                                    foreach (var f in d)
                                                    {
                                                        var countries = (from country in db.Countries
                                                                         where country.ID == f
                                                                         select country);
                                                        foreach (Countries w in countries)
                                                        {
                                                            int CountryId = w.CountryId;
                                                    <option class="search" id="Country" value="@w.CountryId">@w.CountryName </option>
                                                        }
                                                    }
                                                }
                                                }
                                            </select>
                                            }
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td style="line-height: 30px;">
                                <label for="bookname" id="lblbook" style="display:normal">Obra:</label><label style="color:red;float:right;font-size:20px" id="lblbook1">*</label>

                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <select name="book" id="bookn" class="insert form-control" onchange="geteditions($(this).val());" style="text-align: left; display: normal; width: 100%; font-size: 12px; height: 30px"></select>
                            </td>
                        </tr>
                        <tr>
                            <td style="line-height: 30px;">
                                <label for="Edition" id="lblEdition" style="display: normal">Edición:</label><label style="color:red;float:right;font-size:20px" id="lblEdition1">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <select name="Edition" id="Edition" class="insert form-control" onchange="getclients($(this).val());" style="text-align: left; display: normal; width: 100%; font-size: 12px; height: 30px"></select>
                            </td>
                        </tr>
                        <tr>
                            <td style="line-height: 30px;">
                                <label for="DivisionName" id="lblclient" style="display: normal">Cliente:</label><label style="color:red;float:right;font-size:20px" id="lblclient1">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <select name="clients" id="clients" class="insert form-control" onchange="getresults($(this).val());" style="text-align: left; display: normal; width: 100%; font-size: 12px; height: 30px"></select>
                            </td>
                        </tr>
                    </table>
                </div>
                    }
                    else
                    {
                <div style="width: 100%;">
                    <table style="width:100%" border="0">
                        <tr>
                            <td width="100px">
                                <label class="lblcountrywhite">País:</label><label style="color:red;float:right;font-size:20px">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <div style="text-align:left;">
                                    @using (Html.BeginForm())
                                            {
                                            <select name="pais" id="pais" onchange="getbook($(this).val());" class="country form-control" style="text-align: left; width: 100%; font-size: 12px; height: 30px;">
                                                <option class="null">Seleccione...</option>
                                                @{
                                                CountriesUsers p = (CountriesUsers)Session["CountriesUsers"];
                                                if (Session["CountriesUsers"] == null)
                                                {
                                                    Session.Abandon();
                                                    Response.Redirect(Url.Action("Logout", "Login"));
                                                    Response.End();
                                                }
                                                else if (p != null)
                                                {
                                                    List<string> d = p.var;
                                                    foreach (var f in d)
                                                    {
                                                        var countries = (from country in db.Countries
                                                                         where country.ID == f
                                                                         select country);
                                                        foreach (Countries w in countries)
                                                        {
                                                            int CountryId = ind.CId;
                                                            if (w.CountryId == CountryId)
                                                            {
                                                    <option class="search" id="Country" selected="selected" value="@w.CountryId">@w.CountryName </option>
                                                            }
                                                            else
                                                            {
                                                    <option class="search" id="Country" value="@w.CountryId">@w.CountryName </option>
                                                            }

                                                        }
                                                    }
                                                }
                                                }
                                            </select>
                                            }
                                </div>
                            </td>
                            <td rowspan="4"></td>
                            <td rowspan="4" style="text-align:center">
                                <a target="_blank" href="@Url.Action("GetReportProduction", "GetReports", new { id = "PDF" })"><img src="@Url.Content("~/Images/pdfproductsbyclient.png")" style="height:75px;width:60px"></a>
                            </td>
                            <td rowspan="4" style="text-align:center">
                                <a target="_blank" href="@Url.Action("GetReportProductsByEditionProduction", "GetReports", new { id = "PDF" })"><img src="@Url.Content("~/Images/pdfproductsbyedition.png")" style="height:75px;width:60px"></a>
                            </td>
                        </tr>
                        <tr>
                            <td style="line-height: 30px;">
                                <label for="bookname" id="lblbook" style="display:normal">Obra:</label><label style="color:red;float:right;font-size:20px;" id="lblbook1">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px; height: 30px">
                                <select name="book" id="bookn" class="insert form-control" onchange="geteditions($(this).val());" style="text-align: left; display: normal; width: 100%; font-size: 12px; height: 30px">
                                    <option>Seleccione...</option>
                                    @{
                                            int BookId = ind.BId;

                                            var bk = (from book in db.Books
                                                      where book.BookId == BookId
                                                      select book).ToList();
                                            foreach (Books _book in bk)
                                            {
                                                if (_book.BookId == BookId)
                                                {
                                            <option value="@_book.BookId" selected="selected">@_book.BookName</option>
                                                }
                                                else
                                                {
                                            <option value="@_book.BookId">@_book.BookName</option>
                                                }
                                            }
                                    }
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td style="line-height: 30px;">
                                <label for="Edition" id="lblEdition" style="display: normal">Edición:</label><label style="color:red;float:right;font-size:20px" id="lblEdition1">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <select name="Edition" id="Edition" class="insert form-control" onchange="getclients($(this).val());" style="text-align: left; display: normal; width: 100%; font-size: 12px; height: 30px">
                                    <option>Seleccione...</option>
                                    @{
                                            int EditionId = ind.EId;
                                            int CountryIds = ind.CId;
                                            var ed = (from _ed in db.Editions
                                                      where _ed.CountryId == CountryIds
                                                      select _ed).ToList();

                                            foreach (Editions _ed in ed)
                                            {
                                                if (_ed.EditionId == EditionId)
                                                {
                                            <option value="@_ed.EditionId" selected="selected">@_ed.NumberEdition</option>
                                                }
                                                else
                                                {
                                            <option value="@_ed.EditionId">@_ed.NumberEdition</option>
                                                }
                                            }
                                    }
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td style="line-height: 30px;">
                                <label for="DivisionName" id="lblclient" style="display: normal">Cliente:</label><label style="color:red;float:right;font-size:20px" id="lblclient1">*</label>
                            </td>
                            <td style="line-height: 30px;width:15px"></td>
                            <td style="line-height: 30px;">
                                <select name="clients" id="clients" class="insert form-control" onchange="getresults($(this).val());" style="text-align: left; display: normal; width:100%; font-size: 12px; height: 30px">
                                    <option>Seleccione...</option>
                                    @{
                                            byte clienttypeid = 0;
                                            var ct = (from clientt in db.ClientTypes
                                                      where clientt.TypeName == "ANUNCIANTE"
                                                      select clientt).ToList();
                                            foreach (ClientTypes _ct in ct)
                                            {
                                                clienttypeid = _ct.ClientTypeId;
                                            }

                                            var _clients = (from c in db.Clients
                                                            join ec in db.EditionClients
                                                            on c.ClientId equals ec.ClientId
                                                            where ec.ClientTypeId == clienttypeid
                                                            && c.CountryId == CountryIdss
                                                            orderby c.CompanyName ascending
                                                            select c).Distinct().OrderBy(x => x.CompanyName).ToList();
                                            foreach (Clients c in _clients)
                                            {
                                            <option value="@c.ClientId">@c.CompanyName</option>
                                            }
                                    }
                                </select>
                            </td>
                        </tr>
                    </table>
                </div>
                    }
                }
            </td>
        </tr>
        <tr>
            <td colspan="3"><label></label></td>
        </tr>
        @{
            if (ind != null)
            {
                <tr>
                    <td style="width: 10%;"><label class="labels">País:</label></td>
                    <td style="width: 1%;"></td>
                    <td>
                        @{
                var cts = (from _ct in db.Countries
                           where _ct.CountryId == CountryIdss
                           select _ct).ToList();
                foreach (Countries _ct in cts)
                {
                        <label>@_ct.CountryName</label>
                }
                        }
                    </td>
                </tr>
                <tr>
                    <td style="width:10%"><label class="labels">Libro:</label></td>
                    <td style="width:1%"></td>
                    <td>
                        @{
                var bks = (from _bk in db.Books
                           where _bk.BookId == BookIds
                           select _bk).ToList();
                foreach (Books _bks in bks)
                {
                        <label>@_bks.BookName</label>
                }
                        }
                    </td>
                </tr>
                <tr>
                    <td style="width:10%"><label class="labels">Edición:</label></td>
                    <td></td>
                    <td>
                        @{
                var eds = (from _ed in db.Editions
                           where _ed.EditionId == EditionIds
                           select _ed).ToList();
                foreach (Editions _eds in eds)
                {
                        <label>@_eds.NumberEdition</label>
                }
                        }
                    </td>
                </tr>
                <tr>
                    <td style="width:10%"><label class="labels">Cliente:</label></td>
                    <td style="width:1%"></td>
                    <td>
                        @{
                var cl = (from _cl in db.Clients
                          where _cl.ClientId == ClientIdss
                          select _cl).ToList();
                foreach (Clients _cl in cl)
                {
                        <label>@_cl.CompanyName</label>
                }
                        }
                    </td>
                </tr>
            }
        }
        <tr>
            <td colspan="3" style="text-align:right">
                @{
                    if (ind != null)
            {
                using (Html.BeginForm("searchproduct", "Production"))
                {
                <label>Buscar Producto:&nbsp;</label>  @Html.TextBox("ProductName", "", new { @class = "form-focus" })
                <button type="submit" id="searchp" value="searchprod" class="btn btn-info searchoproducts" style="color: #333; width: 40px; font-size: 18px"><img src="@Url.Content("~/Images/buscar.png")" style=" height:20px;width:20px;"></button>
                }
            }
                }
            </td>
        </tr>
        <tr>
            <td colspan="3">
                <div style="text-align: center; width: 100%; height: 100%; ">
                    @{
                        var count = ViewData["Count"];
                        var countprod = ViewData["Countresults"];
                        if ((count == null) && (countprod != null))
                        {
                    <label class="labels">Se han encontrado: @ViewData["Countresults"] resultados</label>
                        }
                        else if ((countprod == null) && (count == null))
                        {
                    <label id="result" style="display:normal; color:red;text-align:center">No se Han Encontrado Productos en esta Edición para el Cliente</label>
                        }
                    }
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="4" style="text-align: center; line-height: 40px;"></td>
        </tr>
    </table>
    <br />

    @{

        if (ind != null)
        {
            <input type="text" id="text" style="display: none" />
            <div style="width: 100%; height: 100%; display: normal;" id="productsprod">
                <br />
                @_datagrid.GetHtml(
                          headerStyle: "webgrid-header1",
                          footerStyle: "webgrid-footer",
                          alternatingRowStyle: "webgrid-alternating-row",
                          selectedRowStyle: "webgrid-selected-row",
                          rowStyle: "webgrid-row-style",
                          tableStyle: "webgrid-table ",
                          mode: WebGridPagerModes.All,
                          columns: new[] {
                          _datagrid.Column("", header: "Nombre de Producto", format: @<text>
                                @{
                                    <span class="display-modes"> <label id="lblName">@item.ProductName</label> </span>
                                    <textarea style="display:none; color:red; font-size: 12px;" maxlength="200" id="txtaName" class="edit-modes edprod form-control">@item.ProductName</textarea>
                                    <input id="lblProductidPe" style="visibility: visible;display:none; width:20px" value="@item.ProductId" />
                                }
                        </text>),

            _datagrid.Column("", header: "Editar", format: @<text>
                    @{
                        <button style="color: #333; width: 45px;height:35px" class="edit-users display-modes btn btn-info"><img src="@Url.Content("~/Images/edit.png")" style="height:25px;width:25px;"></button>
                        <button style="color: #333; display: none; width: 45px; height: 35px; " class="save-users edit-modes btn btn-warning"><img src="@Url.Content("~/Images/save.png")" style="height:25px;width:20px;"></button>
                        <button style="color: #333; display: none; width: 45px; height: 35px; " class="cancel-users edit-modes btn btn-warning"><img src="@Url.Content("~/Images/cancel.png")" style="height:25px;width:20px;"></button>
                    }
            </text>, style:"buton column5"),

          _datagrid.Column("", header: "SIDEF", format: @<text>
                    @{
                                    sessionproduction index = (sessionproduction)Session["sessionproduction"];
                                    if(index != null)
                                    {
                                        int editionid = index.EId;
                                        int clientid = index.ClId;
                                        int ProductId = item.ProductId;
                                        var ecps = (from ecp in db.ParticipantProducts
                                                        where ecp.ClientId == clientid
                                                        && ecp.EditionId == editionid
                                                        && ecp.ProductId == ProductId
                                                        && ecp.Active == true
                                                        select ecp).ToList();
                                       bool request = false;
                                       foreach (ParticipantProducts _ecps in ecps)
                                       {
                                           if(@item.ProductId == _ecps.ProductId)
                                           {
                                               request = true;
                                           }
                                       }
                                        <input type="checkbox" class="request" checked="@request" disabled />

                                        <img src="@Url.Action("showimagesdetails", "Production", new { image = @item.ProductId, client = clientid, edition = editionid })" style="color: #333; width: 50px; height: 50px; cursor: pointer" class="imagesins" onclick="location.href='@Url.Action("images", "Production", new { ProductId = @item.ProductId, client = clientid, edition = editionid })';return false;" />
                                    }
                    }
        </text>,style:"buton column15"),
            _datagrid.Column("", header: "Asociar Archivo PDF", format: @<text>
                    @{
                        if (ind != null)
                        {
                            int ClientId = ind.ClId;
                            int EditionId = ind.EId;
                            int ProductId = item.ProductId;
                            var PP = (from partp in db.ParticipantProducts
                                      where partp.ProductId == ProductId
                                          && partp.ClientId == ClientId
                                          && partp.EditionId == EditionId
                                          && partp.FileName != null
                                      select partp).ToList();
                            if (PP.LongCount() > 0)
                            {
                                foreach (ParticipantProducts _pp in PP)
                                {
                                    <img src="@Url.Content("~/Images/pdfproductionfilecontent.png")" style="height:50px;width:60px;" class="edit-user display-mode btn return">
                                }
                            }
                            else
                            {
                                <img src="@Url.Content("~/Images/expand.png")" style="height:50px;width:60px;" class="edit-user display-mode btn return">
                            }
                            <div style="display:none" id="divcontainerpdf" class="save-user edit-mode">
                                <input type="text" style="height:35px;display:none" id="text" />
                                <form enctype="multipart/form-data" method="post" id="sendimages">
                                    <input id="uploadFile" placeholder="Seleccione Archivo..."  disabled="disabled" class="form-focus" accept="application/png" />
                                    <div class="fileUpload btn">
                                        <span>
                                            Seleccione...
                                        </span>
                                        <input id="uploadBtn" type="file" class="upload" accept="application/pdf" name="file" />
                                    </div><br />
                                    <div style="text-align:center">
                                    </div>
                                </form>
                            </div>
                            <p style="text-align:center" class="">
                                <button style="display:none" id="" class="save-user edit-mode send">Insertar</button>
                                <button style="display:none" class="cancel-user edit-mode cancell">Cancelar</button>
                            </p>
                        }
                    }
            </text>,style:"buton column2"),
        _datagrid.Column("", header: "Ver PDF", format: @<text>
                    @{
             int ClientId = ind.ClId;
                    int EditionId = ind.EId;
                    int ProductId = item.ProductId;

            var PP = (from partp in db.ParticipantProducts
                      where partp.ProductId == ProductId
                          && partp.ClientId == ClientId
                          && partp.EditionId == EditionId
                          && partp.FileName != null
                      select partp).ToList();
                      if(PP.LongCount()>0)
                      {
                        <a target="_blank" href="@Url.Action("getpdf", "Production", new { ProductId = item.ProductId })"><img src="@Url.Content("~/Images/lookfiles.png")" style="height:60px;width:60px;" class="btn"></a>
                      }
                    }

        </text>,style:"buton column5"),

        _datagrid.Column("", header: "Asociar HTML", format: @<text>
                    @{

                        if (ind != null)
                        {
                            int ClientId = ind.ClId;
                            int EditionId = ind.EId;
                            int ProductId = item.ProductId;
                            var PP = (from partp in db.ParticipantProducts
                                      where partp.ProductId == ProductId
                                          && partp.ClientId == ClientId
                                          && partp.EditionId == EditionId
                                          && partp.HTMLContent != null
                                      select partp).ToList();
                            if (PP.LongCount() > 0)
                            {
                                foreach (ParticipantProducts _pp in PP)
                                {
                                    <img src="@Url.Content("~/Images/HTML.png")" style="height:50px;width:60px;" class="btn return" onclick="location.href='@Url.Action("segmenthtml", "Production", new { ProductId = item.ProductId })';return false;">
                                }
                            }
                            else
                            {
                                <img src="@Url.Content("~/Images/expand.png")" style="height:50px;width:60px;" class="btn return" onclick="location.href='@Url.Action("segmenthtml", "Production", new { ProductId = item.ProductId })';return false;">

                            }
                        }
                    }
        </text>,style:"buton column5"),
        })
            </div>
        }
    }
</body>
</html>
